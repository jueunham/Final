<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="web.dao.admin.face.AdminDao">

<select id="selectAll" parameterType="web.util.admin.Paging" resultType="web.dto.Member" >
	SELECT * FROM 
	( SELECT rownum rnum, B.* FROM 
	( SELECT * FROM MEMBER 
	<where>
	<if test="search != null">
	MEMBER_ID LIKE #{search}
	</if>
	</where>
	ORDER by MEMBER_NO desc) 
	
	B ORDER by rnum ) WHERE rnum between #{startNo} and #{endNo}
	</select>


	<select id="selectCntAll"  resultType="int" parameterType="map">
	SELECT count(*) FROM MEMBER
	<trim prefix="WHERE" prefixOverrides="OR">
		<if test="select != null and select =='member_name' and search != null">
		member_name = #{search}
		</if>
		<if test="select != null and select =='member_id' and search != null ">
		member_id = #{search}
		</if>
	</trim>
	
	</select>


<select id="selectCorAll" parameterType="web.util.admin.Paging" resultType="web.dto.Member" >
SELECT * FROM 
( SELECT rownum rnum, B.* 
FROM 
( SELECT 
    member.member_no, 
    member.member_id, 
    member.member_name, 
    member.member_phone, 
    member.member_email, 
    member.member_auth, 
    cor.cor_name as company_name
    FROM 
    MEMBER, cor 
	WHERE 
	<if test="search != null">
	MEMBER_ID LIKE '%#{search}%' 
	</if>
	and member.company_no = cor.cor_no
	ORDER by MEMBER_NO desc)
	B ORDER by rnum ) WHERE rnum between #{startNo} and #{endNo}
	</select>

</mapper>